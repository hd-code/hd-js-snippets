"use strict";
/*! storage v0.0.1 from hd-snippets-js | MIT | © Hannes Dröse https://github.com/hd-code/hd-snippets-js */var __importStar=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r};Object.defineProperty(exports,"__esModule",{value:!0});var fs=__importStar(require("fs")),path=__importStar(require("path"));function CacheStorage(){return BaseStorage({})}function LocalStorage(e){function a(){var e=n.getAll();saveToFile(r,e)}var r=e?path.resolve(e):path.resolve(__dirname,defaultFileName),n=BaseStorage(initLocalStorage(r));return{clear:function(){var e=n.clear();return a(),e},delete:function(e){var r=n.delete(e);return a(),r},filter:n.filter,get:n.get,getAll:n.getAll,save:function(e){var r=n.save(e);return a(),r},set:function(e,r){var t=n.set(e,r);return a(),t}}}function BaseStorage(a){return{clear:function(){var e=a;return a={},e},delete:function(e){var r=a[e];return delete a[e],r},filter:function(e){var r={};for(var t in a)try{e(a[t])&&(r[t]=a[t])}catch(e){}return r},get:function(e){return a[e]},getAll:function(){return a},save:function(e){for(var r="";r=generateKey(),void 0!==a[r];);return a[r]=e,r},set:function(e,r){var t=a[e];return a[e]=r,t}}}exports.CacheStorage=CacheStorage,exports.LocalStorage=LocalStorage;var hexBase=16,autoKeyLength=16;function generateKey(){for(var e=[],r=0;r<autoKeyLength;r++)e.push(generateHexDigit());return e.join("")}function generateHexDigit(){return Math.floor(Math.random()*hexBase).toString(hexBase)[0]}var defaultFileName="localstorage.json";function initLocalStorage(r){try{var e=fs.readFileSync(r),t=JSON.parse(e);if("object"!=typeof t||!t)throw new Error("Invalid file content");return t}catch(e){return saveToFile(r,{}),{}}}function saveToFile(e,r){var t=JSON.stringify(r);fs.writeFileSync(e,t)}